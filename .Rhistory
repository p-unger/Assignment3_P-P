table(z$workstatus[z$sex==2])
table(z$workstatus[z$sex==1 & z$wrkstat==7])
table(z$workstatus[z$sex==2 & z$wrkstat==7])
table(z$workstatus[z$sex==1 & z$educat==4])
table(z$workstatus[z$sex==2 & z$educat==4])
z = z[z$year >= 1977 & z$year < 2012,]
t <- subset(z, z$educat==4)
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(0.25,0.4)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(0.25,0.4)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,50)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("Low-income", "High-income")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$income_status <- NA
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1 <- NA
z$income_status1[z$career==1] <- "High-income"
z$income_status1[z$career==0] <- "Low-income"
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1 <- NA
z$income_status1[z$career==1] <- "High-income"
z$income_status1[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$income_status1 <- NA
z$income_status1[z$career1==1] <- "High-income"
z$income_status1[z$career1==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$meanhap <- NA
z$meanhap[z$family==0 & z$career==0] <- "No career, no family"
z$meanhap[z$family==0 & z$career==1] <- "Career, no family"
z$meanhap[z$family==1 & z$career==0] <- "No career, family"
z$meanhap[z$family==1 & z$career==1] <- "Career, family"
t <- subset(z, z$educat==4)
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family", "Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family",
"Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$working_ft <- as.numeric(z$working_ft)
z$working_pt <- as.numeric(z$working_pt)
M1a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M2a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
# compare men and women
require("interplot")
require("gridExtra")
interM1 <- interplot(M1a, var1 = "married", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of marriage on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM2 <- interplot(M2a, var1 = "married", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM1, interM2, ncol = 2)
M3 <- lm(vhappy ~ career*family + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M4 <- lm(vhappy ~ career*family + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
# Compare men and women (Career-Family interaction)
interM3 <- interplot(M3, var1 = "family", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of family on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM4 <- interplot(M4, var1 = "family", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM3, interM4, ncol = 2)
devtools::install_github("rstudio/flexdashboard")
source('deflator.R')
setwd("~/Documents/CDA/collaborative_projects/Assignment3_P-P") # Unger
save( PCE , file = "data/PCE.rda")
setwd("~/Documents/CDA/collaborative_projects/Assignment3_P-P") # Unger
setwd("~/Documents/CDA/collaborative_projects/Assignment3_P-P") # Unger
source('deflator.R')
if(!file.exists('data/CPS_Bertrand.rda')) {
source('CPS_Bertrand.R')
}
if(!exists("CPS.df" )) {
load("data/CPS_Bertrand.rda")
}
if(!file.exists("data/GSS.CS.rda")) {
source('GSS_data_downloader.R')
}
if(!exists("GSS.CS.df" )) {
load("data/GSS.CS.rda")
}
if(!file.exists("data/data_final.rda")) {
source('GSS_prep_dynamic.R')
}
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family",
"Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z = z[z$year >= 1977 & z$year < 2012,]
z$income_status <- NA
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1 <- NA
z$income_status1[z$career1==1] <- "High-income"
z$income_status1[z$career1==0] <- "Low-income"
z$meanhap <- NA
z$meanhap[z$family==0 & z$career1==0] <- "No career, no family"
z$meanhap[z$family==0 & z$career1==1] <- "Career, no family"
z$meanhap[z$family==1 & z$career1==0] <- "No career, family"
z$meanhap[z$family==1 & z$career1==1] <- "Career, family"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family",
"Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$workstatus <- NA
z$workstatus[z$wrkstat==1] <- "Full-time work"
z$workstatus[z$wrkstat==2] <- "Part-time work"
z$workstatus[z$wrkstat==7] <- "Keeping house"
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work",
"Keeping house")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work",
"Keeping house")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold 25th percentile") +
theme_bw()
z = z[z$year >= 1977 & z$year < 2012,]
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold 25th percentile") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("High-income", "Low-income")) +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold 25th percentile") +
theme_bw()
z$meanhap <- NA
z$meanhap[z$family==0 & z$career==0] <- "Low-income, no family"
z$meanhap[z$family==0 & z$career==1] <- "High-income, no family"
z$meanhap[z$family==1 & z$career==0] <- "Low-income, family"
z$meanhap[z$family==1 & z$career==1] <- "High-income, family"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("Low-income, no family",
"High-income, no family", "Low-income, family", "High-income, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$working_ft <- as.numeric(z$working_ft)
z$working_pt <- as.numeric(z$working_pt)
M1a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M2a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
interM1 <- interplot(M1a, var1 = "married", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of marriage on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM2 <- interplot(M2a, var1 = "married", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM1, interM2, ncol = 2)
z$working_ft <- as.numeric(z$working_ft)
z$working_pt <- as.numeric(z$working_pt)
M1a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M2a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
# compare men and women
require("interplot")
require("gridExtra")
interM1 <- interplot(M1a, var1 = "married", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of marriage on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM2 <- interplot(M2a, var1 = "married", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM1, interM2, ncol = 2)
interM1 <- interplot(M1a, var1 = "married", var2 = "career") +
ggtitle("Working women") +
xlab("1 = high-income") +
ylab("effect of marriage on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM2 <- interplot(M2a, var1 = "married", var2 = "career") +
ggtitle("Working men") +
xlab("1 = high-income") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM1, interM2, ncol = 2)
barplot(happy_dist,
col=c("navyblue"),
xlab = "Distribution of happiness",
ylab = "Frequency"
legend = c("Reported happiness"),
ylim = c(0, 80))
barplot(happy_dist,
col=c("navyblue"),
xlab = "Distribution of happiness",
ylab = "Frequency",
legend = c("Reported happiness"),
ylim = c(0, 80))
happy_dist <- table(z$happy)/sum(table(z$happy))*100
satjob_dist <- table(z$satjob)/sum(table(z$happy))*100
barplot(happy_dist,
col=c("navyblue"),
xlab = "Distribution of happiness",
ylab = "Frequency",
legend = c("Reported happiness"),
ylim = c(0, 80))
barplot(happy_dist,
col=c("navyblue"),
xlab = "Distribution of happiness",
ylab = "Frequency",
legend = c("Reported happiness"),
ylim = c(0, 80))
barplot(satjob_dist,
col=c("navyblue"),
xlab = "Distribution of job-satisfaction",
legend = c("Job satisfcation"),
ylim = c(0, 80))
```
par(mfrow=c(1,2))
barplot(happy_dist,
col=c("navyblue"),
xlab = "Distribution of happiness",
ylab = "Frequency",
legend = c("Reported happiness"),
ylim = c(0, 80))
barplot(satjob_dist,
col=c("navyblue"),
xlab = "Distribution of job-satisfaction",
legend = c("Job satisfcation"),
ylim = c(0, 80))
```
par(mfrow=c(1,2))
barplot(happy_dist,
col=c("navyblue"),
xlab = "Reported happiness",
ylab = "Frequency (percent)",
legend = c("Reported happiness"),
ylim = c(0, 80))
barplot(satjob_dist,
col=c("navyblue"),
xlab = "Reported job-satisfaction",
legend = c("Job satisfcation"),
ylim = c(0, 80))
z$vhappy <- z$vhappy*100
ggplot(z, aes(x=factor(year), y=vhappy)) +
stat_summary(fun.y="mean", geom="point", col="Navyblue") +
scale_x_discrete("Year", labels = c("1973" = "", "1975" = "", "1977" = "", "1980" = "", "1983" = "", "1985" = "", "1987" = "", "1987" = "", "1989" = "", "1991" = "", "1993" = "", "1996" = "", "2000" = "", "2004" = "", "2008" = "", "2012" = "")) +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,45)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 2 & t$educat==4,], aes(x=factor(workstatus), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1 & t$educat ==4,], aes(x=factor(workstatus), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work",
"Keeping house")) +
expand_limits(y=c(20,60)) +
scale_y_continuous("Percentage very happy") +
theme_bw()
t <- z[!is.na(z$wrkstat),]
t$workstatus[t$wrkstat==1] <- "Full-time work"
t$workstatus[t$wrkstat==2] <- "Part-time work"
t$workstatus[t$wrkstat==7] <- "Keeping house"
z$workstatus <- NA
z$workstatus[z$wrkstat==1] <- "Full-time work"
z$workstatus[z$wrkstat==2] <- "Part-time work"
z$workstatus[z$wrkstat==7] <- "Keeping house"
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work",
"Keeping house")) +
expand_limits(y=c(20,60)) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("High-income", "Low-income")) +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold 25th percentile") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete(limits=c("High-income", "Low-income")) +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold 25th percentile") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("High-income", "Low-income")) +
scale_y_continuous("") +
ggtitle("B. Threshold: 50th percentile") +
theme_bw()
z$meanhap <- NA
z$meanhap[z$family==0 & z$career==0] <- "Low-inc., no family"
z$meanhap[z$family==0 & z$career==1] <- "High-inc., no family"
z$meanhap[z$family==1 & z$career==0] <- "Low-inc., family"
z$meanhap[z$family==1 & z$career==1] <- "High-inc., family"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("Low-inc., no family",
"High-inc., no family", "Low-inc., family", "High-inc., family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z = z[z$year >= 1977 & z$year < 2012,]
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
# Following Bertrand (2013), respondents who report no income (Not applicable) is coded as
# having low-income. Thus there are no N/A's in the career variables (see also below).
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1[z$career1==1] <- "High-income"
z$income_status1[z$career1==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("High-income", "Low-income")) +
scale_y_continuous("Percentage very happy") +
ggtitle("A. Threshold: 25th percentile") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappyb),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappyb),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("High-income", "Low-income")) +
scale_y_continuous("") +
ggtitle("B. Threshold: 50th percentile") +
theme_bw()
summary(M1a)
