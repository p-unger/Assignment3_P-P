stat_summary(data = t[t$sex == 2 & married == 1,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1 & married == 1,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 2 & t$married == 1,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1 & t$married == 1,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 2 & t$family == 1,], aes(x=factor(wrkstat), y=vhappy1),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 2 & t$family == 0,], aes(x=factor(wrkstat), y=vhappy1),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(0.2,0.5)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 2 & t$family == 1,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 2 & t$family == 0,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(0.2,0.5)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 2 & t$career == 1,], aes(x=factor(spwrksta), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 2 & t$career == 0,], aes(x=factor(spwrksta), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
table(t$spwrksta)
t$spouse_work <- null
t$spouse_work <- NULL
t$spouse_work[t$spwrksta==1] <- 1
t$spouse_work[t$spwrksta==2] <- 2
t$spouse_work[t$spwrksta==7] <- 7
ggplot() +
stat_summary(data = t[t$sex == 2 & t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 2 & t$career == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
t$ujobsat1 <- t$satjob == 1 | t$satjob == 2 | t$satjob == 3
t$ujobsat1 <- as.numeric(t$ujobsat1)
table(t$ujobsat1)
ggplot() +
stat_summary(data = t[t$sex == 2 & t$ujobsat1 == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 2 & t$ujobsat1 == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 & t$ujobsat1 == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1 & t$ujobsat1 == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$ujobsat1 == 0,], aes(x=factor(sex), y=vhappy),
fun.y="mean", geom="point", col="Navyblue"))
ggplot() +
stat_summary(data = t[t$ujobsat1 == 0,], aes(x=factor(sex), y=vhappy),
fun.y="mean", geom="point", col="Navyblue")
ggplot() +
stat_summary(data = t[t$ujobsat1 == 0,], aes(x=factor(sex), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 & t$ujobsat1 == 0 & t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1 & t$ujobsat1 == 0 & t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$career == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$family == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$family == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$family == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$family == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$career == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$career == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$career == 1 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$career == 0 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
table(t$hrs1)
describe(t$hrs1)
hist(t$hrs1)
t$hardwork <- NULL
t$hardwork[t$hrs1 > 50] <- 1
t$hardwork <- as.numeric(t$hardwork)
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$hardwork == 1 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$hardwork == 0 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
table(t$hardwork)
t$hardwork <- NULL
t$hardwork[t$hrs1 > 50] <- 1
t$hardwork[t$hrs1 < 50] <- 0
t$hardwork <- as.numeric(t$hardwork)
table(t$hardwork)
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$hardwork == 1 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$hardwork == 0 & t$working_ft == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1 &  t$hardwork == 1 & t$working_ft == 1 & t$kid == 1,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = t[t$sex == 1  & t$hardwork == 1 & t$working_ft == 1 & t$kid == 0,], aes(x=factor(spouse_work), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
theme_bw()
table(t$hrs2)
describe(t$hrs2)
setwd("~/Documents/CDA/collaborative_projects/Assignment3_P-P")
install.packages("interplot")
setwd("~/Documents/CDA/collaborative_projects/Assignment3_P-P") # Unger
source('deflator.R')
if(!file.exists("CPS_Bertrand.rda")) {
source('CPS_Bertrand.R')
}
# Opens CPS_Bertrand.rda if the previous step was skipped (to save computational power)
if(!exists("CPS.df" )) {
load("CPS_Bertrand.rda")
}
if(!file.exists("GSS.CS.rda")) {
source('GSS_data_downloader.R')
}
if(!exists("GSS.CS.df" )) {
load("GSS.CS.rda")
}
if(!file.exists("data_final.rda")) {
source('GSS_prep_dynamic.R')
}
describe(z$vhappy)
describe(z$vhappyb)
z$vhappy <- z$happy==1
z$vhappy <- as.numeric(z$vhappy)
describe(z$vhappy)
describe(z$educat)
describe(z$lothinc)
describe(z$p25)
describe(z$p50)
describe(z$career)
describe(z$happyb)
z$vhappyb <- z$vhappy*100
describe(z$vhappy)
describe(z$vhappyb)
table(z$spouse_work)
z$spouse_work <- NULL
z$spouse_work[z$spwrksta==1] <- 1
z$spouse_work[z$spwrksta==2] <- 2
z$spouse_work[z$spwrksta==7] <- 7
table(z$spouse_work)
table(z$vjobsat)
table(z$vjobsat1)
z$vjobsat1 <- z$satjob == 4
z$vjobsat2 <- z$satjob == 3 | t$satjob == 4
z$vjobsat1 <- as.numeric(z$vjobsat1)
z$vjobsat2 <- as.numeric(z$vjobsat2)
z$vjobsat1 <- z$satjob == 4
z$vjobsat2 <- z$satjob == 3 | <$satjob == 4
z$vjobsat1 <- as.numeric(z$vjobsat1)
z$vjobsat2 <- as.numeric(z$vjobsat2)
z$vjobsat1 <- z$satjob == 4
z$vjobsat2 <- z$satjob == 3 | z$satjob == 4
z$vjobsat1 <- as.numeric(z$vjobsat1)
z$vjobsat2 <- as.numeric(z$vjobsat2)
table(z$vjobsat1)
table(z$vjobsat2)
table(z$d_sex)
z$d_sex <- z$sex == 1
z$d_sex <- as.numeric(z$d_sex)
table(z$d_sex)
z = z[z$year >= 1977 & z$year < 2012,]
source('deflator.R')
if(!exists("CPS.df" )) {
load("CPS_Bertrand.rda")
}
if(!exists("GSS.CS.df" )) {
load("GSS.CS.rda")
}
if(!file.exists("data_final.rda")) {
source('GSS_prep_dynamic.R')
}
ggplot() +
stat_summary(data = t[t$sex == 1 & t$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2 & t$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Age") +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,60)) +
theme_bw()
z$vhappy <- z$vhappy*100
ggplot(z, aes(x=factor(year), y=vhappy)) +
stat_summary(fun.y="mean", geom="point", col="Navyblue") +
scale_x_discrete("Year", labels = c("1973" = "", "1975" = "", "1977" = "", "1980" = "", "1983" = "", "1985" = "", "1987" = "", "1987" = "", "1989" = "", "1991" = "", "1993" = "", "1996" = "", "2000" = "", "2004" = "", "2008" = "", "2012" = "")) +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,45)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Age") +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Age") +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,60)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat == 4,], aes(x=factor(age), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Age") +
scale_y_continuous("Percentage very happy") +
expand_limits(y=c(20,60)) +
theme_bw()
hist(z$hrs1[z$working_ft==1],
col=c("navyblue"),
border = "White",
xlab = "Hours worked last week (full-time employees)"
)
hist(z$hrs1[z$working_ft==1],
col=c("navyblue"),
border = "White",
xlab = "Hours worked last week (full-time employees)"
)
par(mfrow=c(1,1))
hist(z$hrs1[z$working_ft==1],
col=c("navyblue"),
border = "White",
xlab = "Hours worked last week (full-time employees)"
)
?hist
par(mfrow=c(1,1))
satjob_dist <- table(z$satjob)/sum(table(z$happy))*100
hist(z$hrs1[z$working_ft==1],
col=c("navyblue"),
border = "White",
xlab = "Hours worked last week (full-time employees)",
main = ""
)
ggplot() +
stat_summary(data = z[z$sex == 2 ,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 ,], aes(x=factor(wrkstat), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
theme_bw()
z$workstatus <- NA
z$workstatus[z$wrkstat==1] <- "Full-time work"
z$workstatus[z$wrkstat==2] <- "Part-time work"
z$workstatus[z$wrkstat==7] <- "Keeping house"
ggplot() +
stat_summary(data = z[z$sex == 2 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
scale_x_discrete("Work status") +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 ,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work", "Keeping house")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,40)) +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work", "Keeping house")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Red") +
stat_summary(data = z[z$sex == 1 & z$educat ==4,], aes(x=factor(workstatus), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
expand_limits(y=c(20,60)) +
scale_x_discrete("Work status", limits=c("Full-time work", "Part-time work", "Keeping house")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
table(z$workstatus[z$sex==1])
table(z$workstatus[z$sex==2])
table(z$workstatus[z$sex==1 & z$wrkstat==7])
table(z$workstatus[z$sex==2 & z$wrkstat==7])
table(z$workstatus[z$sex==1 & z$educat==4])
table(z$workstatus[z$sex==2 & z$educat==4])
z = z[z$year >= 1977 & z$year < 2012,]
t <- subset(z, z$educat==4)
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(0.25,0.4)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(0.25,0.4)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,50)) +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job", limits=c("Low-income", "High-income")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(career), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$income_status <- NA
z$income_status[z$career==1] <- "High-income"
z$income_status[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1 <- NA
z$income_status1[z$career==1] <- "High-income"
z$income_status1[z$career==0] <- "Low-income"
z$career1 <- z$rinc > z$p50
z$career1 <- as.numeric(z$career1)
z$career1[is.na(z$career1)] <- 0
z$income_status1 <- NA
z$income_status1[z$career==1] <- "High-income"
z$income_status1[z$career==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$income_status1 <- NA
z$income_status1[z$career1==1] <- "High-income"
z$income_status1[z$career1==0] <- "Low-income"
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2  & z$educat==4,], aes(x=factor(income_status1), y=vhappy),
fun.y="mean", geom="point", col="Red") +
expand_limits(y=c(25,45)) +
scale_x_discrete("High- or low-income job") +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$meanhap <- NA
z$meanhap[z$family==0 & z$career==0] <- "No career, no family"
z$meanhap[z$family==0 & z$career==1] <- "Career, no family"
z$meanhap[z$family==1 & z$career==0] <- "No career, family"
z$meanhap[z$family==1 & z$career==1] <- "Career, family"
t <- subset(z, z$educat==4)
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
theme_bw()
ggplot() +
stat_summary(data = t[t$sex == 1,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = t[t$sex == 2,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family", "Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
ggplot() +
stat_summary(data = z[z$sex == 1 & z$educat==4 ,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Navyblue") +
stat_summary(data = z[z$sex == 2 & z$educat==4,], aes(x=factor(meanhap), y=vhappy),
fun.y="mean", geom="point", col="Red") +
scale_x_discrete("Family-work combination", limits=c("No career, no family",
"Career, no family", "No career, family", "Career, family")) +
scale_y_continuous("Percentage very happy") +
theme_bw()
z$working_ft <- as.numeric(z$working_ft)
z$working_pt <- as.numeric(z$working_pt)
M1a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M2a <- lm(vhappy ~ career*married + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
# compare men and women
require("interplot")
require("gridExtra")
interM1 <- interplot(M1a, var1 = "married", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of marriage on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM2 <- interplot(M2a, var1 = "married", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM1, interM2, ncol = 2)
M3 <- lm(vhappy ~ career*family + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==2 & educat == 4))
M4 <- lm(vhappy ~ career*family + age + agesq + as.factor(year) + as.factor(race) + as.factor(bdec),
data = subset(z, sex==1 & educat == 4))
# Compare men and women (Career-Family interaction)
interM3 <- interplot(M3, var1 = "family", var2 = "career") +
ggtitle("Working women") +
xlab("career") +
ylab("effect of family on life satisfaction") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
interM4 <- interplot(M4, var1 = "family", var2 = "career") +
ggtitle("Working men") +
xlab("career") +
expand_limits(y=c(0.05,0.3)) +
theme_bw()
grid.arrange(interM3, interM4, ncol = 2)
devtools::install_github("rstudio/flexdashboard")
